#+title: Umask
#+author:gabriel
#+description: 104.5

Existe um comando interno do shell que Ã© responsÃ¡vel por definir as permissÃµes padrÃµes para novos arquivos e diretÃ³rios criados por um usuÃ¡rio, este comando Ã© o ~umask~

*Certs only work with perm 600(octal)*

#+begin_src sh
umask

[13:48][]~ âœ® umask
002
#+end_src

Para visualizar as permissÃµes aplicadas pelo umask ->
#+begin_src sh
umask -S
#+end_src

Este comando pode ser definido nos arquivos profiles, ou seja, */etc/profile* que Ã© utilizado por todos os usuÃ¡rios do sistema.

Para calcular as permissÃµes para novos arquivos e diretÃ³rios utilizando a umask, as seguintes permissÃµes devem ser levadas em consideraÃ§Ã£o para o calculo

*"Default" Permissions* ->
| Arquivos | 666 | rw-rw-rw |
| DiretÃ³rios | 777 | rwx-rwx-rwx |


*Permissions* ->
| Leitura | 4 | r |
| Escrita | 2 | w |
| ExecuÃ§Ã£o | 1 | x |
| Leitura , Escrita e ExecuÃ§Ã£o | 7 | rwx |
| Leitura e Escrita | 6 | rw |
| Leitura e ExecuÃ§Ã£o | 5 | rx |
| Escrita e ExecuÃ§Ã£o | 3 | wx |

*Binary representation* ->
| 0 | 000 |
| 1 | 001 |
| 2 | 010 |
| 3 | 011 |
| 4 | 100 |
| 5 | 101 |
| 6 | 110 |
| 7 | 111 |

* exemplos

*Default perm binary for files 110 110 110 (666 octal)*
*Default Perm binary for dir 111 111 111 (777 octal)*


*1 for dirs* ->
umask = 021 (octal umask)

000 010 001 (binary umask)

111 101 110 (not umask)

[[./imgs/1_dir.png]]

*1 for files* ->
umask = 021(octal umask)

000 010 001(binary umask)

111 101 110(not umask)

[[./imgs/1_file.png]]

*2 for dirs* ->
umask = 023(octal umask)

000 010 011(binary umask)

111 101 100(not umask)

[[./imgs/2_dir.png]]

*2 for files* ->
umask = 023(octal umask)

000 010 011(binary umask)

111 101 100(not umask)

[[./imgs/2_file.png]]

*3 for dirs* ->
umask = 034(octal umask)

000 011 100(binary umask)

111 100 011(not umask)

[[./imgs/3_dir.png]]


*3 for file* ->
umask = 034(octal umask)

000 011 100(binary umask)

111 100 011(not umask)

[[./imgs/3_file.png]]

* pulo do gato

O pulo do gato para acelar o calculo, Ã© sempre tirar das permissÃµes padrÃµes para diretÃ³rios 777 e arquivos 666, somente as permissÃµes definidas na umask e que estÃ£o presentes nas permissÃµes padrÃµes para diretÃ³rios e arquivos

*example 1* ->

[[./imgs/pulo_gato.png]]


* resumo visual

| Tipo         | Base padrÃ£o | PermissÃ£o final | SubtraÃ§Ã£o       | umask |
| ---------------- | ----------- | --------------- | --------------- | ----- |
| ğŸ— Arquivo   | 666         | 644 (rw-r--r--) | 6-6 / 6-4 / 6-4 | 022   |
| ğŸ“‚ DiretÃ³rio | 777         | 750 (rwxr-x---) | 7-7 / 7-5 / 7-0 | 027   |
| ğŸ— Arquivo   | 666         | 642 (rw-r---w-) | 6-6 / 6-4 / 6-2 | 024   |

âš¡ Resumindo o Fluxo

ğŸ— Arquivo â†’ base 666 | ğŸ“‚ DiretÃ³rio â†’ base 777
Converter permissÃ£o final para octal.
Calcular coluna a coluna:

 * ğŸ‘¤ umask_user = base_user - final_user
 * ğŸ‘¥ umask_group = base_group - final_group
 * ğŸŒ umask_others = base_others - final_others

Juntar os trÃªs resultados â†’ umask final.
